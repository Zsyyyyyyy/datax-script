{
    "job": {
        "content": [
            {
                "reader": {
                    "name": "mongodbreader",
                    "parameter": {
                        "address": [
                            "$mongodburl"
                        ],
                        "collectionName": "shop",
                        "authDb": "admin",
                        "query": "{ 'updateTime' : { $lt: new Date($yyyy,$MM,$dd) }}",
                        "column": [
                            {
                                "name": "_id",
                                "type": "string"
                            },
                            {
                                "name": "shopCode",
                                "type": "string"
                            },
                            {
                                "name": "userId",
                                "type": "string"
                            },
                            {
                                "name": "merchantId",
                                "type": "string"
                            },
                            {
                                "name": "shopName",
                                "type": "string"
                            },
                            {
                                "name": "shopImgs",
                                "type": "string"
                            },
                            {
                                "name": "shopVideos",
                                "type": "string"
                            },
                            {
                                "name": "coverUrl",
                                "type": "string"
                            },
                            {
                                "name": "lon",
                                "type": "string"
                            },
                            {
                                "name": "lat",
                                "type": "string"
                            },
                            {
                                "name": "geoSpatial",
                                "type": "string"
                            },
                            {
                                "name": "geohash",
                                "type": "string"
                            },
                            {
                                "name": "province",
                                "type": "string"
                            },
                            {
                                "name": "provinceCode",
                                "type": "string"
                            },
                            {
                                "name": "city",
                                "type": "string"
                            },
                            {
                                "name": "cityCode",
                                "type": "string"
                            },
                            {
                                "name": "county",
                                "type": "string"
                            },
                            {
                                "name": "countyCode",
                                "type": "string"
                            },
                            {
                                "name": "address",
                                "type": "string"
                            },
                            {
                                "name": "divisionsCode",
                                "type": "string"
                            },
                            {
                                "name": "serviceTel",
                                "type": "string"
                            },
                            {
                                "name": "shopIntroduce",
                                "type": "string"
                            },
                            {
                                "name": "shopFacility",
                                "type": "string"
                            },
                            {
                                "name": "closed",
                                "type": "string"
                            },
                            {
                                "name": "shopType",
                                "type": "string"
                            },
                            {
                                "name": "shopStatus",
                                "type": "string"
                            },
                            {
                                "name": "shopAuditStatus",
                                "type": "string"
                            },
                            {
                                "name": "starFlag",
                                "type": "string"
                            },
                            {
                                "name": "blankFlag",
                                "type": "string"
                            },
                            {
                                "name": "recommend",
                                "type": "string"
                            },
                            {
                                "name": "isMeetGift",
                                "type": "string"
                            },
                            {
                                "name": "delFlag",
                                "type": "string"
                            },
                            {
                                "name": "shopOwnerInfo",
                                "type": "string"
                            },
                            {
                                "name": "shopOpenTime",
                                "type": "string"
                            },
                            {
                                "name": "shopVip",
                                "type": "string"
                            },
                            {
                                "name": "businessScopes",
                                "type": "string"
                            },
                            {
                                "name": "shopStatisticsInfo",
                                "type": "string"
                            },
                            {
                                "name": "createTime",
                                "type": "string"
                            },
                            {
                                "name": "updateTime",
                                "type": "string"
                            },
                            {
                                "name": "distance",
                                "type": "string"
                            },
                            {
                                "name": "settlementInfo",
                                "type": "string"
                            },
                            {
                                "name": "recommendStartTime",
                                "type": "string"
                            },
                            {
                                "name": "recommendEndTime",
                                "type": "string"
                            },
                            {
                                "name": "recommendEffectiveDistance",
                                "type": "string"
                            },
                            {
                                "name": "recommendTransregionalDistance",
                                "type": "string"
                            },
                            {
                                "name": "isIndependentManagement",
                                "type": "string"
                            },
                            {
                                "name": "parentId",
                                "type": "string"
                            },
                            {
                                "name": "managerPhone",
                                "type": "string"
                            },
                            {
                                "name": "isBindAccount",
                                "type": "string"
                            },
                            {
                                "name": "shopAccountType",
                                "type": "string"
                            },
                            {
                                "name": "registerReason",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateSource",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateTime",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateUser",
                                "type": "string"
                            },
                            {
                                "name": "companyName",
                                "type": "string"
                            },
                            {
                                "name": "usci",
                                "type": "string"
                            },
                            {
                                "name": "legalPersonName",
                                "type": "string"
                            }
                        ],
                        "dbName": "platform_shop_management",
                        "userName": "$mongodbusername",
                        "userPassword": "$mongodbpassword"
                    }
                },
                "writer": {
                    "name": "hdfswriter",
                    "parameter": {
                        "column": [
                            {
                                "name": "id",
                                "type": "string"
                            },
                            {
                                "name": "shopCode",
                                "type": "string"
                            },
                            {
                                "name": "userId",
                                "type": "string"
                            },
                            {
                                "name": "merchantId",
                                "type": "string"
                            },
                            {
                                "name": "shopName",
                                "type": "string"
                            },
                            {
                                "name": "shopImgs",
                                "type": "string"
                            },
                            {
                                "name": "shopVideos",
                                "type": "string"
                            },
                            {
                                "name": "coverUrl",
                                "type": "string"
                            },
                            {
                                "name": "lon",
                                "type": "string"
                            },
                            {
                                "name": "lat",
                                "type": "string"
                            },
                            {
                                "name": "geoSpatial",
                                "type": "string"
                            },
                            {
                                "name": "geohash",
                                "type": "string"
                            },
                            {
                                "name": "province",
                                "type": "string"
                            },
                            {
                                "name": "provinceCode",
                                "type": "string"
                            },
                            {
                                "name": "city",
                                "type": "string"
                            },
                            {
                                "name": "cityCode",
                                "type": "string"
                            },
                            {
                                "name": "county",
                                "type": "string"
                            },
                            {
                                "name": "countyCode",
                                "type": "string"
                            },
                            {
                                "name": "address",
                                "type": "string"
                            },
                            {
                                "name": "divisionsCode",
                                "type": "string"
                            },
                            {
                                "name": "serviceTel",
                                "type": "string"
                            },
                            {
                                "name": "shopIntroduce",
                                "type": "string"
                            },
                            {
                                "name": "shopFacility",
                                "type": "string"
                            },
                            {
                                "name": "closed",
                                "type": "string"
                            },
                            {
                                "name": "shopType",
                                "type": "string"
                            },
                            {
                                "name": "shopStatus",
                                "type": "string"
                            },
                            {
                                "name": "shopAuditStatus",
                                "type": "string"
                            },
                            {
                                "name": "starFlag",
                                "type": "string"
                            },
                            {
                                "name": "blankFlag",
                                "type": "string"
                            },
                            {
                                "name": "recommend",
                                "type": "string"
                            },
                            {
                                "name": "isMeetGift",
                                "type": "string"
                            },
                            {
                                "name": "delFlag",
                                "type": "string"
                            },
                            {
                                "name": "shopOwnerInfo",
                                "type": "string"
                            },
                            {
                                "name": "shopOpenTime",
                                "type": "string"
                            },
                            {
                                "name": "shopVip",
                                "type": "string"
                            },
                            {
                                "name": "businessScopes",
                                "type": "string"
                            },
                            {
                                "name": "shopStatisticsInfo",
                                "type": "string"
                            },
                            {
                                "name": "createTime",
                                "type": "string"
                            },
                            {
                                "name": "updateTime",
                                "type": "string"
                            },
                            {
                                "name": "distance",
                                "type": "string"
                            },
                            {
                                "name": "settlementInfo",
                                "type": "string"
                            },
                            {
                                "name": "recommendStartTime",
                                "type": "string"
                            },
                            {
                                "name": "recommendEndTime",
                                "type": "string"
                            },
                            {
                                "name": "recommendEffectiveDistance",
                                "type": "string"
                            },
                            {
                                "name": "recommendTransregionalDistance",
                                "type": "string"
                            },
                            {
                                "name": "isIndependentManagement",
                                "type": "string"
                            },
                            {
                                "name": "parentId",
                                "type": "string"
                            },
                            {
                                "name": "managerPhone",
                                "type": "string"
                            },
                            {
                                "name": "isBindAccount",
                                "type": "string"
                            },
                            {
                                "name": "shopAccountType",
                                "type": "string"
                            },
                            {
                                "name": "registerReason",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateSource",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateTime",
                                "type": "string"
                            },
                            {
                                "name": "registerOperateUser",
                                "type": "string"
                            },
                            {
                                "name": "companyName",
                                "type": "string"
                            },
                            {
                                "name": "usci",
                                "type": "string"
                            },
                            {
                                "name": "legalPersonName",
                                "type": "string"
                            }
                        ],
                        "fieldDelimiter": "\u0001",
                        "defaultFS": "hdfs://$hdfsurl",
                        "fileName": "shop",
                        "fileType": "parquet",
                        "compress": "snappy",
                        "path": "/cpp_data/mongo/platform_shop_management/shop/full/",
                        "writeMode": "nonConflict",
                        "hadoopConfig": {
                            "parquet.compression": "SNAPPY",
                            "hive.exec.compress.output": true,
                            "mapred.output.compression.codec": "org.apache.hadoop.io.compress.SnappyCodec",
                            "dfs.nameservices": "hzcppprod",
                            "dfs.ha.namenodes.hzcppprod": "prod01,prod02,prod03",
                            "dfs.namenode.rpc-address.hzcppprod.prod01": "prod01:8020",
                            "dfs.namenode.rpc-address.hzcppprod.prod02": "prod02:8020",
                            "dfs.namenode.rpc-address.hzcppprod.prod03": "prod03:8020",
                            "dfs.client.failover.proxy.provider.hzcppprod": "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider"
                        }
                    }
                }
            }
        ],
        "setting": {
            "speed": {
                "channel": "1"
            }
        }
    }
}